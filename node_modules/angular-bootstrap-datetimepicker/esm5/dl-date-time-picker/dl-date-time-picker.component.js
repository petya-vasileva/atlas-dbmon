/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * @license
 * Copyright 2013-present Dale Lotts All Rights Reserved.
 * http://www.dalelotts.com
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/dalelotts/angular-bootstrap-datetimepicker/blob/master/LICENSE
 */
import { ChangeDetectionStrategy, Component, ElementRef, EventEmitter, Input, NgZone, Output } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import * as _moment from 'moment';
import { take } from 'rxjs/operators';
import { DlDateAdapter } from '../core';
import { DlDateTimePickerChange } from './dl-date-time-picker-change';
import { DlDayModelProvider } from './dl-model-provider-day';
import { DlHourModelProvider } from './dl-model-provider-hour';
import { DlMinuteModelProvider } from './dl-model-provider-minute';
import { DlMonthModelProvider } from './dl-model-provider-month';
import { DlYearModelProvider } from './dl-model-provider-year';
/**
 * Work around for moment namespace conflict when used with webpack and rollup.
 * See https://github.com/dherges/ng-packagr/issues/163
 *
 * Depending on whether rollup is used, moment needs to be imported differently.
 * Since Moment.js doesn't have a default export, we normally need to import using
 * the `* as`syntax.
 *
 * rollup creates a synthetic default module and we thus need to import it using
 * the `default as` syntax.
 *
 * \@internal
 *
 * @type {?}
 */
var moment = _moment;
/**
 * Maps key codes to the model provider function name
 * that should be called to perform the action.
 *
 * \@internal
 *
 * @type {?}
 */
var keyCodeToModelProviderMethod = {
    'ArrowDown': 'goDown',
    'ArrowLeft': 'goLeft',
    'ArrowRight': 'goRight',
    'ArrowUp': 'goUp',
    'Down': 'goDown',
    'End': 'goEnd',
    'Home': 'goHome',
    'Left': 'goLeft',
    'PageDown': 'pageDown',
    'PageUp': 'pageUp',
    'Right': 'goRight',
    'Up': 'goUp',
    33: 'pageUp',
    34: 'pageDown',
    35: 'goEnd',
    36: 'goHome',
    37: 'goLeft',
    38: 'goUp',
    39: 'goRight',
    40: 'goDown',
};
/**
 * List of view names for the calendar.
 *
 * This list must be in order from
 * smallest increment of time to largest increment of time.
 *
 * \@internal
 *
 * @type {?}
 */
var VIEWS = [
    'minute',
    'hour',
    'day',
    'month',
    'year'
];
/**
 * Component that provides all of the user facing functionality of the date/time picker.
 * @template D
 */
var DlDateTimePickerComponent = /** @class */ (function () {
    /**
     * Used to construct a new instance of a date/time picker.
     *
     * @param _elementRef
     *  reference to this element.
     * @param _ngZone
     *  reference to an NgZone instance used to select the active element outside of angular.
     * @param _dateAdapter
     *  date adapter for the date type in the model.
     * @param yearModelComponent
     *  provider for the year view model.
     * @param monthModelComponent
     *  provider for the month view model.
     * @param dayModelComponent
     *  provider for the day view model.
     * @param hourModelComponent
     *  provider for the hour view model.
     * @param minuteModelComponent
     *  provider for the minute view model.
     */
    function DlDateTimePickerComponent(_elementRef, _ngZone, _dateAdapter, yearModelComponent, monthModelComponent, dayModelComponent, hourModelComponent, minuteModelComponent) {
        this._elementRef = _elementRef;
        this._ngZone = _ngZone;
        this._dateAdapter = _dateAdapter;
        this.yearModelComponent = yearModelComponent;
        this.monthModelComponent = monthModelComponent;
        this.dayModelComponent = dayModelComponent;
        this.hourModelComponent = hourModelComponent;
        this.minuteModelComponent = minuteModelComponent;
        /**
         * Change listener callback functions registered
         * via `registerOnChange`
         * \@internal
         *
         */
        this._changed = [];
        /**
         * Maps view name to the next view (the view for the next smallest increment of time).
         * \@internal
         *
         */
        this._nextView = {
            'year': 'month',
            'month': 'day',
            'day': 'hour',
            'hour': 'minute'
        };
        /**
         * Maps view name to the previous view (the view for the next largest increment of time).
         * \@internal
         *
         */
        this._previousView = {
            'minute': 'hour',
            'hour': 'day',
            'day': 'month',
            'month': 'year'
        };
        /**
         * Touch listener callback functions registered
         * via `registerOnChange`
         * \@internal
         *
         */
        this._touched = [];
        /**
         * Emits when a `change` event when date/time is selected or
         * the value of the date/time picker changes.
         *
         */
        this.change = new EventEmitter();
        /**
         * Specifies the classes used to display the left icon.
         *
         * This component uses OPENICONIC https://useiconic.com/open
         * by default but any icon library may be used.
         */
        this.leftIconClass = [
            'oi',
            'oi-chevron-left'
        ];
        /**
         * The highest view that the date/time picker can show.
         * Setting this to a view less than year could make it more
         * difficult for the end-user to navigate to certain dates.
         */
        this.maxView = 'year';
        /**
         * The view that will be used for date/time selection.
         *
         * The default of `minute  means that selection will not happen
         * until the end-user clicks on a cell in the minute view.
         *
         * for example, if you want the end-user to select a only day (date),
         * setting `minView` to `day` will cause selection to happen when the
         * end-user selects a cell in the day view.
         *
         * NOTE: This must be set lower than or equal to `startView'
         */
        this.minView = 'minute';
        /**
         * The number of minutes between each `.dl-abdtp-minute` button.
         *
         * Must be greater than `0` and less than `60`.
         */
        this.minuteStep = 5;
        /**
         * Specifies the classes used to display the right icon.
         *
         * This component uses OPENICONIC https://useiconic.com/open
         * by default but any icon library may be used.
         */
        this.rightIconClass = [
            'oi',
            'oi-chevron-right'
        ];
        /* tslint:disable:member-ordering */
        /**
         *  Determine whether or not the `DateButton` is selectable by the end user.
         */
        this.selectFilter = (/**
         * @return {?}
         */
        function () { return true; });
        /**
         * The initial view that the date/time picker will show.
         * The picker will also return to this view after a date/time
         * is selected.
         *
         * NOTE: This must be set lower than or equal to `maxView'
         */
        this.startView = 'day';
        /**
         * Specifies the classes used to display the up icon.
         *
         * This component uses OPENICONIC https://useiconic.com/open
         * by default but any icon library may be used.
         */
        this.upIconClass = [
            'oi',
            'oi-chevron-top'
        ];
        this._viewToModelProvider = {
            year: yearModelComponent,
            month: monthModelComponent,
            day: dayModelComponent,
            hour: hourModelComponent,
            minute: minuteModelComponent,
        };
    }
    Object.defineProperty(DlDateTimePickerComponent.prototype, "model", {
        /* tslint:enable:member-ordering */
        /**
         * Set's the model for the current view after applying the selection filter.
         *
         * @internal
         **/
        set: /* tslint:enable:member-ordering */
        /**
         * Set's the model for the current view after applying the selection filter.
         *
         * \@internal
         *
         * @private
         * @param {?} model
         * @return {?}
         */
        function (model) {
            this._model = this.applySelectFilter(model);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DlDateTimePickerComponent.prototype, "value", {
        /**
         * Returns `D` value of the date/time picker or undefined/null if no value is set.
         **/
        get: /**
         * Returns `D` value of the date/time picker or undefined/null if no value is set.
         *
         * @return {?}
         */
        function () {
            return this._value;
        },
        /**
         * Sets value of the date/time picker and emits a change event if the
         * new value is different from the previous value.
         **/
        set: /**
         * Sets value of the date/time picker and emits a change event if the
         * new value is different from the previous value.
         *
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (this._value !== value) {
                this._value = value;
                this.model = this._viewToModelProvider[this._model.viewName].getModel(this.getStartDate(), this.valueOf);
                this._changed.forEach((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f(value); }));
                this.change.emit(new DlDateTimePickerChange(value));
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DlDateTimePickerComponent.prototype, "valueOf", {
        /**
         * Returns `milliseconds` value of the date/time picker or undefined/null if no value is set.
         **/
        get: /**
         * Returns `milliseconds` value of the date/time picker or undefined/null if no value is set.
         *
         * @return {?}
         */
        function () {
            return this._dateAdapter.toMilliseconds(this._value);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Applies the `selectionFilter` by adding the `dl-abdtp-disabled`
     * class to any `DateButton` where `selectFilter` returned false.
     *
     * @param model
     *  the new model
     *
     * @returns
     *  the supplied model with zero or more `DateButton`'s
     *  having the `dl-abdtp-disabled` class set to `true` if the
     *  selection for that date should be disabled.
     *
     * @internal
     */
    /**
     * Applies the `selectionFilter` by adding the `dl-abdtp-disabled`
     * class to any `DateButton` where `selectFilter` returned false.
     *
     * \@internal
     * @private
     * @param {?} model
     *  the new model
     *
     * @return {?}
     *  the supplied model with zero or more `DateButton`'s
     *  having the `dl-abdtp-disabled` class set to `true` if the
     *  selection for that date should be disabled.
     *
     */
    DlDateTimePickerComponent.prototype.applySelectFilter = /**
     * Applies the `selectionFilter` by adding the `dl-abdtp-disabled`
     * class to any `DateButton` where `selectFilter` returned false.
     *
     * \@internal
     * @private
     * @param {?} model
     *  the new model
     *
     * @return {?}
     *  the supplied model with zero or more `DateButton`'s
     *  having the `dl-abdtp-disabled` class set to `true` if the
     *  selection for that date should be disabled.
     *
     */
    function (model) {
        var _this = this;
        if (this.selectFilter) {
            model.rows = model.rows.map((/**
             * @param {?} row
             * @return {?}
             */
            function (row) {
                row.cells.map((/**
                 * @param {?} dateButton
                 * @return {?}
                 */
                function (dateButton) {
                    /** @type {?} */
                    var disabled = !_this.selectFilter(dateButton, model.viewName);
                    dateButton.classes['dl-abdtp-disabled'] = disabled;
                    if (disabled) {
                        dateButton.classes['aria-disabled'] = true;
                    }
                    return dateButton;
                }));
                return row;
            }));
        }
        return model;
    };
    /**
     * Focuses the `.dl-abdtp-active` cell after the microtask queue is empty.
     * @internal
     **/
    /**
     * Focuses the `.dl-abdtp-active` cell after the microtask queue is empty.
     * \@internal
     *
     * @private
     * @return {?}
     */
    DlDateTimePickerComponent.prototype.focusActiveCell = /**
     * Focuses the `.dl-abdtp-active` cell after the microtask queue is empty.
     * \@internal
     *
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this._ngZone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this._ngZone.onStable.asObservable().pipe(take(1)).subscribe((/**
             * @return {?}
             */
            function () {
                _this._elementRef.nativeElement.querySelector('.dl-abdtp-active').focus();
            }));
        }));
    };
    /**
     * Determines the start date for the picker.
     * @internal
     **/
    /**
     * Determines the start date for the picker.
     * \@internal
     *
     * @private
     * @return {?}
     */
    DlDateTimePickerComponent.prototype.getStartDate = /**
     * Determines the start date for the picker.
     * \@internal
     *
     * @private
     * @return {?}
     */
    function () {
        if (hasValue(this._value)) {
            return this._dateAdapter.toMilliseconds(this._value);
        }
        if (hasValue(this.startDate)) {
            return this.startDate;
        }
        return moment().valueOf();
    };
    /**
     * Determine the start view for the picker
     * @returns
     *  the largest time increment view between the `minView` or `minute` view and the `startView` or `day` view.
     */
    /**
     * Determine the start view for the picker
     * @private
     * @return {?}
     *  the largest time increment view between the `minView` or `minute` view and the `startView` or `day` view.
     */
    DlDateTimePickerComponent.prototype.getStartView = /**
     * Determine the start view for the picker
     * @private
     * @return {?}
     *  the largest time increment view between the `minView` or `minute` view and the `startView` or `day` view.
     */
    function () {
        /** @type {?} */
        var startIndex = Math.max(VIEWS.indexOf(this.minView || 'minute'), VIEWS.indexOf(this.startView || 'day'));
        return VIEWS[startIndex];
    };
    /**
     * Calls all registered `touch` callback functions.
     * @internal
     **/
    /**
     * Calls all registered `touch` callback functions.
     * \@internal
     *
     * @private
     * @return {?}
     */
    DlDateTimePickerComponent.prototype.onTouch = /**
     * Calls all registered `touch` callback functions.
     * \@internal
     *
     * @private
     * @return {?}
     */
    function () {
        this._touched.forEach((/**
         * @param {?} onTouched
         * @return {?}
         */
        function (onTouched) { return onTouched(); }));
    };
    /**
     * Receives configuration changes detected by Angular and passes the changes on
     * to the model providers so the provider is aware of any necessary configuration
     * changes (i.e. minuteStep)
     *
     * @param changes
     *  the input changes detected by Angular.
     */
    /**
     * Receives configuration changes detected by Angular and passes the changes on
     * to the model providers so the provider is aware of any necessary configuration
     * changes (i.e. minuteStep)
     *
     * @param {?} changes
     *  the input changes detected by Angular.
     * @return {?}
     */
    DlDateTimePickerComponent.prototype.ngOnChanges = /**
     * Receives configuration changes detected by Angular and passes the changes on
     * to the model providers so the provider is aware of any necessary configuration
     * changes (i.e. minuteStep)
     *
     * @param {?} changes
     *  the input changes detected by Angular.
     * @return {?}
     */
    function (changes) {
        var _this = this;
        Object.keys(this._viewToModelProvider)
            .map((/**
         * @param {?} key
         * @return {?}
         */
        function (key) { return _this._viewToModelProvider[key]; }))
            .forEach((/**
         * @param {?} provider
         * @return {?}
         */
        function (provider) { return provider.onChanges(changes); }));
        if (this._model) { // only update the model after ngOnInit has set it the first time.
            this.model = this._viewToModelProvider[this._model.viewName].getModel(this._model.activeDate, this.valueOf);
        }
    };
    /**
     * Sets the initial model.
     *
     * @internal
     **/
    /**
     * Sets the initial model.
     *
     * \@internal
     *
     * @return {?}
     */
    DlDateTimePickerComponent.prototype.ngOnInit = /**
     * Sets the initial model.
     *
     * \@internal
     *
     * @return {?}
     */
    function () {
        this.model = this._viewToModelProvider[this.getStartView()].getModel(this.getStartDate(), this.valueOf);
    };
    /**
     * Handles click (and enter & space key down) events on the date elements.
     *
     * If the current view is the minimum view then the date value is selected
     * and the picker returns to the start view.
     *
     * Otherwise the picker displays the next view with the next
     * smallest time increment.
     *
     * @internal
     **/
    /**
     * Handles click (and enter & space key down) events on the date elements.
     *
     * If the current view is the minimum view then the date value is selected
     * and the picker returns to the start view.
     *
     * Otherwise the picker displays the next view with the next
     * smallest time increment.
     *
     * \@internal
     *
     * @param {?} dateButton
     * @return {?}
     */
    DlDateTimePickerComponent.prototype._onDateClick = /**
     * Handles click (and enter & space key down) events on the date elements.
     *
     * If the current view is the minimum view then the date value is selected
     * and the picker returns to the start view.
     *
     * Otherwise the picker displays the next view with the next
     * smallest time increment.
     *
     * \@internal
     *
     * @param {?} dateButton
     * @return {?}
     */
    function (dateButton) {
        if (dateButton.classes['dl-abdtp-disabled']) {
            return;
        }
        /** @type {?} */
        var nextView = this._nextView[this._model.viewName];
        if ((this.minView || 'minute') === this._model.viewName) {
            this.value = this._dateAdapter.fromMilliseconds(dateButton.value);
            nextView = this.startView;
        }
        this.model = this._viewToModelProvider[nextView].getModel(dateButton.value, this.valueOf);
        this.onTouch();
    };
    /**
     * Handles click (and enter & space key down) events on the left button.
     *
     * Changes the displayed time range of the picker to the previous time range.
     * For example, in year view, the previous decade is displayed.
     *
     * @internal
     **/
    /**
     * Handles click (and enter & space key down) events on the left button.
     *
     * Changes the displayed time range of the picker to the previous time range.
     * For example, in year view, the previous decade is displayed.
     *
     * \@internal
     *
     * @return {?}
     */
    DlDateTimePickerComponent.prototype._onLeftClick = /**
     * Handles click (and enter & space key down) events on the left button.
     *
     * Changes the displayed time range of the picker to the previous time range.
     * For example, in year view, the previous decade is displayed.
     *
     * \@internal
     *
     * @return {?}
     */
    function () {
        this.model = this._viewToModelProvider[this._model.viewName].getModel(this._model.leftButton.value, this.valueOf);
        this.onTouch();
    };
    /**
     * Handles click (and enter & space key down) events on the up button.
     *
     * Changes the view of the picker to the next largest time increment.
     * For example, in day view, the next view displayed will be month view.
     *
     * @internal
     **/
    /**
     * Handles click (and enter & space key down) events on the up button.
     *
     * Changes the view of the picker to the next largest time increment.
     * For example, in day view, the next view displayed will be month view.
     *
     * \@internal
     *
     * @return {?}
     */
    DlDateTimePickerComponent.prototype._onUpClick = /**
     * Handles click (and enter & space key down) events on the up button.
     *
     * Changes the view of the picker to the next largest time increment.
     * For example, in day view, the next view displayed will be month view.
     *
     * \@internal
     *
     * @return {?}
     */
    function () {
        this.model = this._viewToModelProvider[this._previousView[this._model.viewName]].getModel(this._model.upButton.value, this.valueOf);
    };
    /**
     * Handles click (and enter & space key down) events on the right button.
     *
     * Changes the displayed time range of the picker to the next time range.
     * For example, in year view, the next decade is displayed.
     *
     * @internal
     **/
    /**
     * Handles click (and enter & space key down) events on the right button.
     *
     * Changes the displayed time range of the picker to the next time range.
     * For example, in year view, the next decade is displayed.
     *
     * \@internal
     *
     * @return {?}
     */
    DlDateTimePickerComponent.prototype._onRightClick = /**
     * Handles click (and enter & space key down) events on the right button.
     *
     * Changes the displayed time range of the picker to the next time range.
     * For example, in year view, the next decade is displayed.
     *
     * \@internal
     *
     * @return {?}
     */
    function () {
        this.model = this._viewToModelProvider[this._model.viewName].getModel(this._model.rightButton.value, this.valueOf);
        this.onTouch();
    };
    /**
     * Handles various key down events to move the `active date` around the calendar.
     *
     * @internal
     **/
    /**
     * Handles various key down events to move the `active date` around the calendar.
     *
     * \@internal
     *
     * @param {?} $event
     * @return {?}
     */
    DlDateTimePickerComponent.prototype._handleKeyDown = /**
     * Handles various key down events to move the `active date` around the calendar.
     *
     * \@internal
     *
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var functionName = keyCodeToModelProviderMethod[$event.key];
        console.log($event, functionName);
        if (functionName) {
            /** @type {?} */
            var modelProvider = this._viewToModelProvider[this._model.viewName];
            this.model = modelProvider[functionName](this._model.activeDate, this.valueOf);
            this.focusActiveCell();
            // Prevent unexpected default actions such as form submission.
            $event.preventDefault();
        }
    };
    /**
     * Implements ControlValueAccessor.registerOnChange to register change listeners.
     * @internal
     **/
    /**
     * Implements ControlValueAccessor.registerOnChange to register change listeners.
     * \@internal
     *
     * @param {?} fn
     * @return {?}
     */
    DlDateTimePickerComponent.prototype.registerOnChange = /**
     * Implements ControlValueAccessor.registerOnChange to register change listeners.
     * \@internal
     *
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this._changed.push(fn);
    };
    /**
     * Implements ControlValueAccessor.registerOnTouched to register touch listeners.
     * @internal
     **/
    /**
     * Implements ControlValueAccessor.registerOnTouched to register touch listeners.
     * \@internal
     *
     * @param {?} fn
     * @return {?}
     */
    DlDateTimePickerComponent.prototype.registerOnTouched = /**
     * Implements ControlValueAccessor.registerOnTouched to register touch listeners.
     * \@internal
     *
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this._touched.push(fn);
    };
    /**
     * Implements ControlValueAccessor.writeValue to store the value from the model.
     * @internal
     **/
    /**
     * Implements ControlValueAccessor.writeValue to store the value from the model.
     * \@internal
     *
     * @param {?} value
     * @return {?}
     */
    DlDateTimePickerComponent.prototype.writeValue = /**
     * Implements ControlValueAccessor.writeValue to store the value from the model.
     * \@internal
     *
     * @param {?} value
     * @return {?}
     */
    function (value) {
        this.value = value;
    };
    DlDateTimePickerComponent.decorators = [
        { type: Component, args: [{
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    preserveWhitespaces: false,
                    providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: DlDateTimePickerComponent,
                            multi: true
                        }
                    ],
                    selector: 'dl-date-time-picker',
                    template: "<div class=\"text-center dl-abdtp-{{_model.viewName}}-view \">\n  <div class=\"row align-items-center no-gutters\">\n    <button class=\"col dl-abdtp-left-button align-items-center\"\n            type=\"button\"\n            [attr.aria-label]=\"_model.leftButton.ariaLabel\"\n            [attr.title]=\"_model.leftButton.ariaLabel\"\n            [ngClass]=\"_model.leftButton.classes\"\n            (click)=\"_onLeftClick()\">\n      <span class=\"left-icon\" [ngClass]=\"leftIconClass\"></span>\n    </button>\n\n    <div *ngIf=\"_model.viewName === (this.maxView || 'year'); then maxViewLabel else defaultViewLabel;\"></div>\n\n    <button class=\"col dl-abdtp-right-button\"\n            type=\"button\"\n            [attr.aria-label]=\"_model.rightButton.ariaLabel\"\n            [attr.title]=\"_model.rightButton.ariaLabel\"\n            (click)=\"_onRightClick()\"\n            [ngClass]=\"_model.rightButton.classes\">\n      <span class=\"right-icon\" [ngClass]=\"rightIconClass\"></span>\n    </button>\n  </div>\n  <div (keydown)=\"_handleKeyDown($event)\">\n    <div *ngIf=\"_model.rowLabels?.length\" class=\"row no-gutters\">\n      <div *ngFor=\"let label of _model.rowLabels\" class=\"col align-items-center no-gutters dl-abdtp-col-label\">{{label}}</div>\n    </div>\n    <div *ngFor=\"let row of _model.rows\" class=\"row align-items-center no-gutters\">\n      <div *ngFor=\"let cell of row.cells\"\n           role=\"gridcell\"\n           class=\"col dl-abdtp-date-button dl-abdtp-{{_model.viewName}} {{cell.value}}\"\n           [ngClass]=\"cell.classes\"\n           [attr.aria-label]=\"cell.ariaLabel\"\n           [attr.aria-disabled]=\"cell.classes['dl-abdtp-disabled']\"\n           [attr.tabindex]=\"cell.classes['dl-abdtp-active'] ? 0 : -1\"\n           (click)=\"_onDateClick(cell)\"\n           (keydown.space)=\"_onDateClick(cell)\"\n           (keydown.enter)=\"_onDateClick(cell)\"\n      >{{cell.display}}</div>\n    </div>\n  </div>\n</div>\n\n<ng-template #maxViewLabel>\n  <div class=\"col-10 dl-abdtp-view-label\">{{_model.viewLabel}}</div>\n</ng-template>\n<ng-template #defaultViewLabel>\n  <button class=\"col-10 dl-abdtp-view-label dl-abdtp-up-button\"\n          type=\"button\"\n          [attr.aria-label]=\"_model.upButton.ariaLabel\"\n          [attr.title]=\"_model.upButton.ariaLabel\"\n          (click)=\"_onUpClick()\"\n          [ngClass]=\"_model.upButton.classes\"\n  >{{_model.viewLabel}}&nbsp;<span class=\"up-icon\" [ngClass]=\"upIconClass\"></span>\n  </button>\n</ng-template>\n",
                    styles: [":host{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.dl-abdtp-col-label,.dl-abdtp-view-label{font-weight:700}.dl-abdtp-date-button,.dl-abdtp-left-button,.dl-abdtp-right-button,.dl-abdtp-view-label{padding:5px;border-radius:999px;cursor:pointer;color:rgba(0,0,0,.87);outline:0}.dl-abdtp-date-button,.dl-abdtp-left-button,.dl-abdtp-right-button,.dl-abdtp-up-button{border-width:0}.dl-abdtp-active:focus,.dl-abdtp-date-button:focus,.dl-abdtp-date-button:hover,.dl-abdtp-left-button:focus,.dl-abdtp-left-button:hover,.dl-abdtp-right-button:focus,.dl-abdtp-right-button:hover,.dl-abdtp-up-button:focus,.dl-abdtp-up-button:hover,.dl-abdtp-view-label:focus{background:rgba(0,0,0,.04)}.dl-abdtp-future,.dl-abdtp-past{color:rgba(0,0,0,.04)}.dl-abdtp-now,.dl-abdtp-now.disabled,.dl-abdtp-now.disabled:hover,.dl-abdtp-now:hover{border-radius:999px;border:1px solid rgba(0,0,0,.25)}.dl-abdtp-selected{color:#fff;background:rgba(0,82,204,.75)}.dl-abdtp-selected:focus,.dl-abdtp-selected:hover{background:#0052cc}.dl-abdtp-disabled{cursor:default;color:rgba(0,0,0,.25)}"]
                }] }
    ];
    /** @nocollapse */
    DlDateTimePickerComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: NgZone },
        { type: DlDateAdapter },
        { type: DlYearModelProvider },
        { type: DlMonthModelProvider },
        { type: DlDayModelProvider },
        { type: DlHourModelProvider },
        { type: DlMinuteModelProvider }
    ]; };
    DlDateTimePickerComponent.propDecorators = {
        change: [{ type: Output }],
        leftIconClass: [{ type: Input }],
        maxView: [{ type: Input }],
        minView: [{ type: Input }],
        minuteStep: [{ type: Input }],
        rightIconClass: [{ type: Input }],
        selectFilter: [{ type: Input }],
        startDate: [{ type: Input }],
        startView: [{ type: Input }],
        upIconClass: [{ type: Input }]
    };
    return DlDateTimePickerComponent;
}());
export { DlDateTimePickerComponent };
if (false) {
    /**
     * Change listener callback functions registered
     * via `registerOnChange`
     * \@internal
     *
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype._changed;
    /**
     * Model for the current view.
     *
     * \@internal
     *
     * @type {?}
     */
    DlDateTimePickerComponent.prototype._model;
    /**
     * Maps view name to the next view (the view for the next smallest increment of time).
     * \@internal
     *
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype._nextView;
    /**
     * Maps view name to the previous view (the view for the next largest increment of time).
     * \@internal
     *
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype._previousView;
    /**
     * Touch listener callback functions registered
     * via `registerOnChange`
     * \@internal
     *
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype._touched;
    /**
     * Stores the selected value for this picker.
     * \@internal
     *
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype._value;
    /**
     * Maps view name to the model provider for that view.
     * \@internal
     *
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype._viewToModelProvider;
    /**
     * Emits when a `change` event when date/time is selected or
     * the value of the date/time picker changes.
     *
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.change;
    /**
     * Specifies the classes used to display the left icon.
     *
     * This component uses OPENICONIC https://useiconic.com/open
     * by default but any icon library may be used.
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.leftIconClass;
    /**
     * The highest view that the date/time picker can show.
     * Setting this to a view less than year could make it more
     * difficult for the end-user to navigate to certain dates.
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.maxView;
    /**
     * The view that will be used for date/time selection.
     *
     * The default of `minute  means that selection will not happen
     * until the end-user clicks on a cell in the minute view.
     *
     * for example, if you want the end-user to select a only day (date),
     * setting `minView` to `day` will cause selection to happen when the
     * end-user selects a cell in the day view.
     *
     * NOTE: This must be set lower than or equal to `startView'
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.minView;
    /**
     * The number of minutes between each `.dl-abdtp-minute` button.
     *
     * Must be greater than `0` and less than `60`.
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.minuteStep;
    /**
     * Specifies the classes used to display the right icon.
     *
     * This component uses OPENICONIC https://useiconic.com/open
     * by default but any icon library may be used.
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.rightIconClass;
    /**
     *  Determine whether or not the `DateButton` is selectable by the end user.
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.selectFilter;
    /**
     *  Start at the view containing startDate when no value is selected.
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.startDate;
    /**
     * The initial view that the date/time picker will show.
     * The picker will also return to this view after a date/time
     * is selected.
     *
     * NOTE: This must be set lower than or equal to `maxView'
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.startView;
    /**
     * Specifies the classes used to display the up icon.
     *
     * This component uses OPENICONIC https://useiconic.com/open
     * by default but any icon library may be used.
     * @type {?}
     */
    DlDateTimePickerComponent.prototype.upIconClass;
    /**
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype._elementRef;
    /**
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype._ngZone;
    /**
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype._dateAdapter;
    /**
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype.yearModelComponent;
    /**
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype.monthModelComponent;
    /**
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype.dayModelComponent;
    /**
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype.hourModelComponent;
    /**
     * @type {?}
     * @private
     */
    DlDateTimePickerComponent.prototype.minuteModelComponent;
}
/**
 * \@internal
 * @param {?} value
 * @return {?}
 */
function hasValue(value) {
    return (typeof value !== 'undefined') && (value !== null);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGwtZGF0ZS10aW1lLXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hbmd1bGFyLWJvb3RzdHJhcC1kYXRldGltZXBpY2tlci8iLCJzb3VyY2VzIjpbImRsLWRhdGUtdGltZS1waWNrZXIvZGwtZGF0ZS10aW1lLXBpY2tlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBU0EsT0FBTyxFQUNMLHVCQUF1QixFQUN2QixTQUFTLEVBQ1QsVUFBVSxFQUNWLFlBQVksRUFDWixLQUFLLEVBQ0wsTUFBTSxFQUdOLE1BQU0sRUFFUCxNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQXVCLGlCQUFpQixFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDdkUsT0FBTyxLQUFLLE9BQU8sTUFBTSxRQUFRLENBQUM7QUFDbEMsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3BDLE9BQU8sRUFBQyxhQUFhLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFDdEMsT0FBTyxFQUFDLHNCQUFzQixFQUFDLE1BQU0sOEJBQThCLENBQUM7QUFJcEUsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0seUJBQXlCLENBQUM7QUFDM0QsT0FBTyxFQUFDLG1CQUFtQixFQUFDLE1BQU0sMEJBQTBCLENBQUM7QUFDN0QsT0FBTyxFQUFDLHFCQUFxQixFQUFDLE1BQU0sNEJBQTRCLENBQUM7QUFDakUsT0FBTyxFQUFDLG9CQUFvQixFQUFDLE1BQU0sMkJBQTJCLENBQUM7QUFDL0QsT0FBTyxFQUFDLG1CQUFtQixFQUFDLE1BQU0sMEJBQTBCLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7SUFldkQsTUFBTSxHQUFHLE9BQU87Ozs7Ozs7OztJQVVoQiw0QkFBNEIsR0FBRztJQUNuQyxXQUFXLEVBQUUsUUFBUTtJQUNyQixXQUFXLEVBQUUsUUFBUTtJQUNyQixZQUFZLEVBQUUsU0FBUztJQUN2QixTQUFTLEVBQUUsTUFBTTtJQUNq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OytCQVVMLEtBQUs7NEJBTUwsS0FBSzs0QkFVTCxLQUFLOzhCQVNMLEtBQUs7O0lBc1NSLGdDQUFDO0NBQUEsQUFsY0QsSUFrY0M7U0FwYlkseUJBQXlCOzs7Ozs7Ozs7O0lBT3BDLDZDQUE4Qzs7Ozs7Ozs7SUFNOUMsMkNBQThCOzs7Ozs7OztJQUs5Qiw4Q0FLRTs7Ozs7Ozs7SUFLRixrREFLRTs7Ozs7Ozs7O0lBTUYsNkNBQXNDOzs7Ozs7OztJQUt0QywyQ0FBa0I7Ozs7Ozs7O0lBS2xCLHlEQU1FOzs7Ozs7O0lBS0YsMkNBQ2dFOzs7Ozs7OztJQU9oRSxrREFJRTs7Ozs7OztJQU1GLDRDQUMrRDs7Ozs7Ozs7Ozs7Ozs7SUFhL0QsNENBQ2lFOzs7Ozs7O0lBTWpFLCtDQUNlOzs7Ozs7OztJQU9mLG1EQUlFOzs7OztJQU1GLGlEQUNnRjs7Ozs7SUFLaEYsOENBQ2tCOzs7Ozs7Ozs7SUFTbEIsOENBQ2dFOzs7Ozs7OztJQVFoRSxnREFJRTs7Ozs7SUFzQlUsZ0RBQStCOzs7OztJQUMvQiw0Q0FBdUI7Ozs7O0lBQ3ZCLGlEQUFzQzs7Ozs7SUFDdEMsdURBQStDOzs7OztJQUMvQyx3REFBaUQ7Ozs7O0lBQ2pELHNEQUE2Qzs7Ozs7SUFDN0MsdURBQStDOzs7OztJQUMvQyx5REFBbUQ7Ozs7Ozs7QUF3UWpFLFNBQVMsUUFBUSxDQUFDLEtBQVU7SUFDMUIsT0FBTyxDQUFDLE9BQU8sS0FBSyxLQUFLLFdBQVcsQ0FBQyxJQUFJLENBQUMsS0FBSyxLQUFLLElBQUksQ0FBQyxDQUFDO0FBQzVELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxMy1wcmVzZW50IERhbGUgTG90dHMgQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqIGh0dHA6Ly93d3cuZGFsZWxvdHRzLmNvbVxuICpcbiAqIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGFuIE1JVC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlXG4gKiBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGF0IGh0dHBzOi8vZ2l0aHViLmNvbS9kYWxlbG90dHMvYW5ndWxhci1ib290c3RyYXAtZGF0ZXRpbWVwaWNrZXIvYmxvYi9tYXN0ZXIvTElDRU5TRVxuICovXG5cbmltcG9ydCB7XG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIEVsZW1lbnRSZWYsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5wdXQsXG4gIE5nWm9uZSxcbiAgT25DaGFuZ2VzLFxuICBPbkluaXQsXG4gIE91dHB1dCxcbiAgU2ltcGxlQ2hhbmdlc1xufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHtDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1J9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCAqIGFzIF9tb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7dGFrZX0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHtEbERhdGVBZGFwdGVyfSBmcm9tICcuLi9jb3JlJztcbmltcG9ydCB7RGxEYXRlVGltZVBpY2tlckNoYW5nZX0gZnJvbSAnLi9kbC1kYXRlLXRpbWUtcGlja2VyLWNoYW5nZSc7XG5pbXBvcnQge0RhdGVCdXR0b259IGZyb20gJy4vZGwtZGF0ZS10aW1lLXBpY2tlci1kYXRlLWJ1dHRvbic7XG5pbXBvcnQge0RsRGF0ZVRpbWVQaWNrZXJNb2RlbH0gZnJvbSAnLi9kbC1kYXRlLXRpbWUtcGlja2VyLW1vZGVsJztcbmltcG9ydCB7RGxNb2RlbFByb3ZpZGVyfSBmcm9tICcuL2RsLW1vZGVsLXByb3ZpZGVyJztcbmltcG9ydCB7RGxEYXlNb2RlbFByb3ZpZGVyfSBmcm9tICcuL2RsLW1vZGVsLXByb3ZpZGVyLWRheSc7XG5pbXBvcnQge0RsSG91ck1vZGVsUHJvdmlkZXJ9IGZyb20gJy4vZGwtbW9kZWwtcHJvdmlkZXItaG91cic7XG5pbXBvcnQge0RsTWludXRlTW9kZWxQcm92aWRlcn0gZnJvbSAnLi9kbC1tb2RlbC1wcm92aWRlci1taW51dGUnO1xuaW1wb3J0IHtEbE1vbnRoTW9kZWxQcm92aWRlcn0gZnJvbSAnLi9kbC1tb2RlbC1wcm92aWRlci1tb250aCc7XG5pbXBvcnQge0RsWWVhck1vZGVsUHJvdmlkZXJ9IGZyb20gJy4vZGwtbW9kZWwtcHJvdmlkZXIteWVhcic7XG5cbi8qKlxuICogV29yayBhcm91bmQgZm9yIG1vbWVudCBuYW1lc3BhY2UgY29uZmxpY3Qgd2hlbiB1c2VkIHdpdGggd2VicGFjayBhbmQgcm9sbHVwLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9kaGVyZ2VzL25nLXBhY2thZ3IvaXNzdWVzLzE2M1xuICpcbiAqIERlcGVuZGluZyBvbiB3aGV0aGVyIHJvbGx1cCBpcyB1c2VkLCBtb21lbnQgbmVlZHMgdG8gYmUgaW1wb3J0ZWQgZGlmZmVyZW50bHkuXG4gKiBTaW5jZSBNb21lbnQuanMgZG9lc24ndCBoYXZlIGEgZGVmYXVsdCBleHBvcnQsIHdlIG5vcm1hbGx5IG5lZWQgdG8gaW1wb3J0IHVzaW5nXG4gKiB0aGUgYCogYXNgc3ludGF4LlxuICpcbiAqIHJvbGx1cCBjcmVhdGVzIGEgc3ludGhldGljIGRlZmF1bHQgbW9kdWxlIGFuZCB3ZSB0aHVzIG5lZWQgdG8gaW1wb3J0IGl0IHVzaW5nXG4gKiB0aGUgYGRlZmF1bHQgYXNgIHN5bnRheC5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqKi9cbmNvbnN0IG1vbWVudCA9IF9tb21lbnQ7XG5cblxuLyoqXG4gKiBNYXBzIGtleSBjb2RlcyB0byB0aGUgbW9kZWwgcHJvdmlkZXIgZnVuY3Rpb24gbmFtZVxuICogdGhhdCBzaG91bGQgYmUgY2FsbGVkIHRvIHBlcmZvcm0gdGhlIGFjdGlvbi5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqKi9cblxuY29uc3Qga2V5Q29kZVRvTW9kZWxQcm92aWRlck1ldGhvZCA9IHtcbiAgJ0Fycm93RG93bic6ICdnb0Rvd24nLFxuICAnQXJyb3dMZWZ0JzogJ2dvTGVmdCcsXG4gICdBcnJvd1JpZ2h0JzogJ2dvUmlnaHQnLFxuICAnQXJyb3dVcCc6ICdnb1VwJyxcbiAgJ0Rvd24nOiAnZ29Eb3duJyxcbiAgJ0VuZCc6ICdnb0VuZCcsXG4gICdIb21lJzogJ2dvSG9tZScsXG4gICdMZWZ0JzogJ2dvTGVmdCcsXG4gICdQYWdlRG93bic6ICdwYWdlRG93bicsXG4gICdQYWdlVXAnOiAncGFnZVVwJyxcbiAgJ1JpZ2h0JzogJ2dvUmlnaHQnLFxuICAnVXAnOiAnZ29VcCcsXG4gIDMzOiAncGFnZVVwJyxcbiAgMzQ6ICdwYWdlRG93bicsXG4gIDM1OiAnZ29FbmQnLFxuICAzNjogJ2dvSG9tZScsXG4gIDM3OiAnZ29MZWZ0JyxcbiAgMzg6ICdnb1VwJyxcbiAgMzk6ICdnb1JpZ2h0JyxcbiAgNDA6ICdnb0Rvd24nLFxufTtcblxuXG4vKipcbiAqIExpc3Qgb2YgdmlldyBuYW1lcyBmb3IgdGhlIGNhbGVuZGFyLlxuICpcbiAqIFRoaXMgbGlzdCBtdXN0IGJlIGluIG9yZGVyIGZyb21cbiAqIHNtYWxsZXN0IGluY3JlbWVudCBvZiB0aW1lIHRvIGxhcmdlc3QgaW5jcmVtZW50IG9mIHRpbWUuXG4gKlxuICogQGludGVybmFsXG4gKiovXG5jb25zdCBWSUVXUyA9IFtcbiAgJ21pbnV0ZScsXG4gICdob3VyJyxcbiAgJ2RheScsXG4gICdtb250aCcsXG4gICd5ZWFyJ1xuXTtcblxuLyoqXG4gKiBDb21wb25lbnQgdGhhdCBwcm92aWRlcyBhbGwgb2YgdGhlIHVzZXIgZmFjaW5nIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIGRhdGUvdGltZSBwaWNrZXIuXG4gKi9cblxuQENvbXBvbmVudCh7XG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICBwcmVzZXJ2ZVdoaXRlc3BhY2VzOiBmYWxzZSxcbiAgcHJvdmlkZXJzOiBbXG4gICAge1xuICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICB1c2VFeGlzdGluZzogRGxEYXRlVGltZVBpY2tlckNvbXBvbmVudCxcbiAgICAgIG11bHRpOiB0cnVlXG4gICAgfVxuICBdLFxuICBzZWxlY3RvcjogJ2RsLWRhdGUtdGltZS1waWNrZXInLFxuICBzdHlsZVVybHM6IFsnLi9kbC1kYXRlLXRpbWUtcGlja2VyLmNvbXBvbmVudC5zY3NzJ10sXG4gIHRlbXBsYXRlVXJsOiAnLi9kbC1kYXRlLXRpbWUtcGlja2VyLmNvbXBvbmVudC5odG1sJyxcbn0pXG5leHBvcnQgY2xhc3MgRGxEYXRlVGltZVBpY2tlckNvbXBvbmVudDxEPiBpbXBsZW1lbnRzIE9uQ2hhbmdlcywgT25Jbml0LCBDb250cm9sVmFsdWVBY2Nlc3NvciB7XG5cbiAgLyoqXG4gICAqIENoYW5nZSBsaXN0ZW5lciBjYWxsYmFjayBmdW5jdGlvbnMgcmVnaXN0ZXJlZFxuICAgKiB2aWEgYHJlZ2lzdGVyT25DaGFuZ2VgXG4gICAqIEBpbnRlcm5hbFxuICAgKiovXG4gIHByaXZhdGUgX2NoYW5nZWQ6ICgodmFsdWU6IEQpID0+IHZvaWQpW10gPSBbXTtcbiAgLyoqXG4gICAqIE1vZGVsIGZvciB0aGUgY3VycmVudCB2aWV3LlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICoqL1xuICBfbW9kZWw6IERsRGF0ZVRpbWVQaWNrZXJNb2RlbDtcbiAgLyoqXG4gICAqIE1hcHMgdmlldyBuYW1lIHRvIHRoZSBuZXh0IHZpZXcgKHRoZSB2aWV3IGZvciB0aGUgbmV4dCBzbWFsbGVzdCBpbmNyZW1lbnQgb2YgdGltZSkuXG4gICAqIEBpbnRlcm5hbFxuICAgKiovXG4gIHByaXZhdGUgX25leHRWaWV3ID0ge1xuICAgICd5ZWFyJzogJ21vbnRoJyxcbiAgICAnbW9udGgnOiAnZGF5JyxcbiAgICAnZGF5JzogJ2hvdXInLFxuICAgICdob3VyJzogJ21pbnV0ZSdcbiAgfTtcbiAgLyoqXG4gICAqIE1hcHMgdmlldyBuYW1lIHRvIHRoZSBwcmV2aW91cyB2aWV3ICh0aGUgdmlldyBmb3IgdGhlIG5leHQgbGFyZ2VzdCBpbmNyZW1lbnQgb2YgdGltZSkuXG4gICAqIEBpbnRlcm5hbFxuICAgKiovXG4gIHByaXZhdGUgX3ByZXZpb3VzVmlldyA9IHtcbiAgICAnbWludXRlJzogJ2hvdXInLFxuICAgICdob3VyJzogJ2RheScsXG4gICAgJ2RheSc6ICdtb250aCcsXG4gICAgJ21vbnRoJzogJ3llYXInXG4gIH07XG4gIC8qKlxuICAgKiBUb3VjaCBsaXN0ZW5lciBjYWxsYmFjayBmdW5jdGlvbnMgcmVnaXN0ZXJlZFxuICAgKiB2aWEgYHJlZ2lzdGVyT25DaGFuZ2VgXG4gICAqIEBpbnRlcm5hbFxuICAgKiovXG4gIHByaXZhdGUgX3RvdWNoZWQ6ICgoKSA9PiB2b2lkKVtdID0gW107XG4gIC8qKlxuICAgKiBTdG9yZXMgdGhlIHNlbGVjdGVkIHZhbHVlIGZvciB0aGlzIHBpY2tlci5cbiAgICogQGludGVybmFsXG4gICAqKi9cbiAgcHJpdmF0ZSBfdmFsdWU6IEQ7XG4gIC8qKlxuICAgKiBNYXBzIHZpZXcgbmFtZSB0byB0aGUgbW9kZWwgcHJvdmlkZXIgZm9yIHRoYXQgdmlldy5cbiAgICogQGludGVybmFsXG4gICAqKi9cbiAgcHJpdmF0ZSByZWFkb25seSBfdmlld1RvTW9kZWxQcm92aWRlcjoge1xuICAgIHllYXI6IERsTW9kZWxQcm92aWRlcjtcbiAgICBtb250aDogRGxNb2RlbFByb3ZpZGVyO1xuICAgIGRheTogRGxNb2RlbFByb3ZpZGVyO1xuICAgIGhvdXI6IERsTW9kZWxQcm92aWRlcjtcbiAgICBtaW51dGU6IERsTW9kZWxQcm92aWRlcjtcbiAgfTtcbiAgLyoqXG4gICAqIEVtaXRzIHdoZW4gYSBgY2hhbmdlYCBldmVudCB3aGVuIGRhdGUvdGltZSBpcyBzZWxlY3RlZCBvclxuICAgKiB0aGUgdmFsdWUgb2YgdGhlIGRhdGUvdGltZSBwaWNrZXIgY2hhbmdlcy5cbiAgICoqL1xuICBAT3V0cHV0KClcbiAgcmVhZG9ubHkgY2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxEbERhdGVUaW1lUGlja2VyQ2hhbmdlPEQ+PigpO1xuICAvKipcbiAgICogU3BlY2lmaWVzIHRoZSBjbGFzc2VzIHVzZWQgdG8gZGlzcGxheSB0aGUgbGVmdCBpY29uLlxuICAgKlxuICAgKiBUaGlzIGNvbXBvbmVudCB1c2VzIE9QRU5JQ09OSUMgaHR0cHM6Ly91c2VpY29uaWMuY29tL29wZW5cbiAgICogYnkgZGVmYXVsdCBidXQgYW55IGljb24gbGlicmFyeSBtYXkgYmUgdXNlZC5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGxlZnRJY29uQ2xhc3M6IHN0cmluZyB8IHN0cmluZ1tdIHwgU2V0PHN0cmluZz4gfCB7fSA9IFtcbiAgICAnb2knLFxuICAgICdvaS1jaGV2cm9uLWxlZnQnXG4gIF07XG4gIC8qKlxuICAgKiBUaGUgaGlnaGVzdCB2aWV3IHRoYXQgdGhlIGRhdGUvdGltZSBwaWNrZXIgY2FuIHNob3cuXG4gICAqIFNldHRpbmcgdGhpcyB0byBhIHZpZXcgbGVzcyB0aGFuIHllYXIgY291bGQgbWFrZSBpdCBtb3JlXG4gICAqIGRpZmZpY3VsdCBmb3IgdGhlIGVuZC11c2VyIHRvIG5hdmlnYXRlIHRvIGNlcnRhaW4gZGF0ZXMuXG4gICAqL1xuICBASW5wdXQoKVxuICBtYXhWaWV3OiAneWVhcicgfCAnbW9udGgnIHwgJ2RheScgfCAnaG91cicgfCAnbWludXRlJyA9ICd5ZWFyJztcbiAgLyoqXG4gICAqIFRoZSB2aWV3IHRoYXQgd2lsbCBiZSB1c2VkIGZvciBkYXRlL3RpbWUgc2VsZWN0aW9uLlxuICAgKlxuICAgKiBUaGUgZGVmYXVsdCBvZiBgbWludXRlICBtZWFucyB0aGF0IHNlbGVjdGlvbiB3aWxsIG5vdCBoYXBwZW5cbiAgICogdW50aWwgdGhlIGVuZC11c2VyIGNsaWNrcyBvbiBhIGNlbGwgaW4gdGhlIG1pbnV0ZSB2aWV3LlxuICAgKlxuICAgKiBmb3IgZXhhbXBsZSwgaWYgeW91IHdhbnQgdGhlIGVuZC11c2VyIHRvIHNlbGVjdCBhIG9ubHkgZGF5IChkYXRlKSxcbiAgICogc2V0dGluZyBgbWluVmlld2AgdG8gYGRheWAgd2lsbCBjYXVzZSBzZWxlY3Rpb24gdG8gaGFwcGVuIHdoZW4gdGhlXG4gICAqIGVuZC11c2VyIHNlbGVjdHMgYSBjZWxsIGluIHRoZSBkYXkgdmlldy5cbiAgICpcbiAgICogTk9URTogVGhpcyBtdXN0IGJlIHNldCBsb3dlciB0aGFuIG9yIGVxdWFsIHRvIGBzdGFydFZpZXcnXG4gICAqL1xuICBASW5wdXQoKVxuICBtaW5WaWV3OiAneWVhcicgfCAnbW9udGgnIHwgJ2RheScgfCAnaG91cicgfCAnbWludXRlJyA9ICdtaW51dGUnO1xuICAvKipcbiAgICogVGhlIG51bWJlciBvZiBtaW51dGVzIGJldHdlZW4gZWFjaCBgLmRsLWFiZHRwLW1pbnV0ZWAgYnV0dG9uLlxuICAgKlxuICAgKiBNdXN0IGJlIGdyZWF0ZXIgdGhhbiBgMGAgYW5kIGxlc3MgdGhhbiBgNjBgLlxuICAgKi9cbiAgQElucHV0KClcbiAgbWludXRlU3RlcCA9IDU7XG4gIC8qKlxuICAgKiBTcGVjaWZpZXMgdGhlIGNsYXNzZXMgdXNlZCB0byBkaXNwbGF5IHRoZSByaWdodCBpY29uLlxuICAgKlxuICAgKiBUaGlzIGNvbXBvbmVudCB1c2VzIE9QRU5JQ09OSUMgaHR0cHM6Ly91c2VpY29uaWMuY29tL29wZW5cbiAgICogYnkgZGVmYXVsdCBidXQgYW55IGljb24gbGlicmFyeSBtYXkgYmUgdXNlZC5cbiAgICovXG4gIEBJbnB1dCgpXG4gIHJpZ2h0SWNvbkNsYXNzID0gW1xuICAgICdvaScsXG4gICAgJ29pLWNoZXZyb24tcmlnaHQnXG4gIF07XG5cbiAgLyogdHNsaW50OmRpc2FibGU6bWVtYmVyLW9yZGVyaW5nICovXG4gIC8qKlxuICAgKiAgRGV0ZXJtaW5lIHdoZXRoZXIgb3Igbm90IHRoZSBgRGF0ZUJ1dHRvbmAgaXMgc2VsZWN0YWJsZSBieSB0aGUgZW5kIHVzZXIuXG4gICAqL1xuICBASW5wdXQoKVxuICBzZWxlY3RGaWx0ZXI6IChkYXRlQnV0dG9uOiBEYXRlQnV0dG9uLCB2aWV3TmFtZTogc3RyaW5nKSA9PiBib29sZWFuID0gKCkgPT4gdHJ1ZVxuXG4gIC8qKlxuICAgKiAgU3RhcnQgYXQgdGhlIHZpZXcgY29udGFpbmluZyBzdGFydERhdGUgd2hlbiBubyB2YWx1ZSBpcyBzZWxlY3RlZC5cbiAgICovXG4gIEBJbnB1dCgpXG4gIHN0YXJ0RGF0ZTogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgaW5pdGlhbCB2aWV3IHRoYXQgdGhlIGRhdGUvdGltZSBwaWNrZXIgd2lsbCBzaG93LlxuICAgKiBUaGUgcGlja2VyIHdpbGwgYWxzbyByZXR1cm4gdG8gdGhpcyB2aWV3IGFmdGVyIGEgZGF0ZS90aW1lXG4gICAqIGlzIHNlbGVjdGVkLlxuICAgKlxuICAgKiBOT1RFOiBUaGlzIG11c3QgYmUgc2V0IGxvd2VyIHRoYW4gb3IgZXF1YWwgdG8gYG1heFZpZXcnXG4gICAqL1xuICBASW5wdXQoKVxuICBzdGFydFZpZXc6ICd5ZWFyJyB8ICdtb250aCcgfCAnZGF5JyB8ICdob3VyJyB8ICdtaW51dGUnID0gJ2RheSc7XG5cbiAgLyoqXG4gICAqIFNwZWNpZmllcyB0aGUgY2xhc3NlcyB1c2VkIHRvIGRpc3BsYXkgdGhlIHVwIGljb24uXG4gICAqXG4gICAqIFRoaXMgY29tcG9uZW50IHVzZXMgT1BFTklDT05JQyBodHRwczovL3VzZWljb25pYy5jb20vb3BlblxuICAgKiBieSBkZWZhdWx0IGJ1dCBhbnkgaWNvbiBsaWJyYXJ5IG1heSBiZSB1c2VkLlxuICAgKi9cbiAgQElucHV0KClcbiAgdXBJY29uQ2xhc3MgPSBbXG4gICAgJ29pJyxcbiAgICAnb2ktY2hldnJvbi10b3AnXG4gIF07XG5cbiAgLyoqXG4gICAqIFVzZWQgdG8gY29uc3RydWN0IGEgbmV3IGluc3RhbmNlIG9mIGEgZGF0ZS90aW1lIHBpY2tlci5cbiAgICpcbiAgICogQHBhcmFtIF9lbGVtZW50UmVmXG4gICAqICByZWZlcmVuY2UgdG8gdGhpcyBlbGVtZW50LlxuICAgKiBAcGFyYW0gX25nWm9uZVxuICAgKiAgcmVmZXJlbmNlIHRvIGFuIE5nWm9uZSBpbnN0YW5jZSB1c2VkIHRvIHNlbGVjdCB0aGUgYWN0aXZlIGVsZW1lbnQgb3V0c2lkZSBvZiBhbmd1bGFyLlxuICAgKiBAcGFyYW0gX2RhdGVBZGFwdGVyXG4gICAqICBkYXRlIGFkYXB0ZXIgZm9yIHRoZSBkYXRlIHR5cGUgaW4gdGhlIG1vZGVsLlxuICAgKiBAcGFyYW0geWVhck1vZGVsQ29tcG9uZW50XG4gICAqICBwcm92aWRlciBmb3IgdGhlIHllYXIgdmlldyBtb2RlbC5cbiAgICogQHBhcmFtIG1vbnRoTW9kZWxDb21wb25lbnRcbiAgICogIHByb3ZpZGVyIGZvciB0aGUgbW9udGggdmlldyBtb2RlbC5cbiAgICogQHBhcmFtIGRheU1vZGVsQ29tcG9uZW50XG4gICAqICBwcm92aWRlciBmb3IgdGhlIGRheSB2aWV3IG1vZGVsLlxuICAgKiBAcGFyYW0gaG91ck1vZGVsQ29tcG9uZW50XG4gICAqICBwcm92aWRlciBmb3IgdGhlIGhvdXIgdmlldyBtb2RlbC5cbiAgICogQHBhcmFtIG1pbnV0ZU1vZGVsQ29tcG9uZW50XG4gICAqICBwcm92aWRlciBmb3IgdGhlIG1pbnV0ZSB2aWV3IG1vZGVsLlxuICAgKi9cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBfZWxlbWVudFJlZjogRWxlbWVudFJlZixcbiAgICAgICAgICAgICAgcHJpdmF0ZSBfbmdab25lOiBOZ1pvbmUsXG4gICAgICAgICAgICAgIHByaXZhdGUgX2RhdGVBZGFwdGVyOiBEbERhdGVBZGFwdGVyPEQ+LFxuICAgICAgICAgICAgICBwcml2YXRlIHllYXJNb2RlbENvbXBvbmVudDogRGxZZWFyTW9kZWxQcm92aWRlcixcbiAgICAgICAgICAgICAgcHJpdmF0ZSBtb250aE1vZGVsQ29tcG9uZW50OiBEbE1vbnRoTW9kZWxQcm92aWRlcixcbiAgICAgICAgICAgICAgcHJpdmF0ZSBkYXlNb2RlbENvbXBvbmVudDogRGxEYXlNb2RlbFByb3ZpZGVyLFxuICAgICAgICAgICAgICBwcml2YXRlIGhvdXJNb2RlbENvbXBvbmVudDogRGxIb3VyTW9kZWxQcm92aWRlcixcbiAgICAgICAgICAgICAgcHJpdmF0ZSBtaW51dGVNb2RlbENvbXBvbmVudDogRGxNaW51dGVNb2RlbFByb3ZpZGVyKSB7XG5cbiAgICB0aGlzLl92aWV3VG9Nb2RlbFByb3ZpZGVyID0ge1xuICAgICAgeWVhcjogeWVhck1vZGVsQ29tcG9uZW50LFxuICAgICAgbW9udGg6IG1vbnRoTW9kZWxDb21wb25lbnQsXG4gICAgICBkYXk6IGRheU1vZGVsQ29tcG9uZW50LFxuICAgICAgaG91cjogaG91ck1vZGVsQ29tcG9uZW50LFxuICAgICAgbWludXRlOiBtaW51dGVNb2RlbENvbXBvbmVudCxcbiAgICB9O1xuICB9XG5cbiAgLyogdHNsaW50OmVuYWJsZTptZW1iZXItb3JkZXJpbmcgKi9cbiAgLyoqXG4gICAqIFNldCdzIHRoZSBtb2RlbCBmb3IgdGhlIGN1cnJlbnQgdmlldyBhZnRlciBhcHBseWluZyB0aGUgc2VsZWN0aW9uIGZpbHRlci5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqKi9cbiAgcHJpdmF0ZSBzZXQgbW9kZWwobW9kZWw6IERsRGF0ZVRpbWVQaWNrZXJNb2RlbCkge1xuICAgIHRoaXMuX21vZGVsID0gdGhpcy5hcHBseVNlbGVjdEZpbHRlcihtb2RlbCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBgRGAgdmFsdWUgb2YgdGhlIGRhdGUvdGltZSBwaWNrZXIgb3IgdW5kZWZpbmVkL251bGwgaWYgbm8gdmFsdWUgaXMgc2V0LlxuICAgKiovXG4gIGdldCB2YWx1ZSgpOiBEIHtcbiAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB2YWx1ZSBvZiB0aGUgZGF0ZS90aW1lIHBpY2tlciBhbmQgZW1pdHMgYSBjaGFuZ2UgZXZlbnQgaWYgdGhlXG4gICAqIG5ldyB2YWx1ZSBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgcHJldmlvdXMgdmFsdWUuXG4gICAqKi9cbiAgc2V0IHZhbHVlKHZhbHVlOiBEKSB7XG4gICAgaWYgKHRoaXMuX3ZhbHVlICE9PSB2YWx1ZSkge1xuICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTtcbiAgICAgIHRoaXMubW9kZWwgPSB0aGlzLl92aWV3VG9Nb2RlbFByb3ZpZGVyW3RoaXMuX21vZGVsLnZpZXdOYW1lXS5nZXRNb2RlbCh0aGlzLmdldFN0YXJ0RGF0ZSgpLCB0aGlzLnZhbHVlT2YpO1xuICAgICAgdGhpcy5fY2hhbmdlZC5mb3JFYWNoKGYgPT4gZih2YWx1ZSkpO1xuICAgICAgdGhpcy5jaGFuZ2UuZW1pdChuZXcgRGxEYXRlVGltZVBpY2tlckNoYW5nZTxEPih2YWx1ZSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGBtaWxsaXNlY29uZHNgIHZhbHVlIG9mIHRoZSBkYXRlL3RpbWUgcGlja2VyIG9yIHVuZGVmaW5lZC9udWxsIGlmIG5vIHZhbHVlIGlzIHNldC5cbiAgICoqL1xuICBnZXQgdmFsdWVPZigpOiBudW1iZXIgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5fZGF0ZUFkYXB0ZXIudG9NaWxsaXNlY29uZHModGhpcy5fdmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGxpZXMgdGhlIGBzZWxlY3Rpb25GaWx0ZXJgIGJ5IGFkZGluZyB0aGUgYGRsLWFiZHRwLWRpc2FibGVkYFxuICAgKiBjbGFzcyB0byBhbnkgYERhdGVCdXR0b25gIHdoZXJlIGBzZWxlY3RGaWx0ZXJgIHJldHVybmVkIGZhbHNlLlxuICAgKlxuICAgKiBAcGFyYW0gbW9kZWxcbiAgICogIHRoZSBuZXcgbW9kZWxcbiAgICpcbiAgICogQHJldHVybnNcbiAgICogIHRoZSBzdXBwbGllZCBtb2RlbCB3aXRoIHplcm8gb3IgbW9yZSBgRGF0ZUJ1dHRvbmAnc1xuICAgKiAgaGF2aW5nIHRoZSBgZGwtYWJkdHAtZGlzYWJsZWRgIGNsYXNzIHNldCB0byBgdHJ1ZWAgaWYgdGhlXG4gICAqICBzZWxlY3Rpb24gZm9yIHRoYXQgZGF0ZSBzaG91bGQgYmUgZGlzYWJsZWQuXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKi9cbiAgcHJpdmF0ZSBhcHBseVNlbGVjdEZpbHRlcihtb2RlbDogRGxEYXRlVGltZVBpY2tlck1vZGVsKTogRGxEYXRlVGltZVBpY2tlck1vZGVsIHtcbiAgICBpZiAodGhpcy5zZWxlY3RGaWx0ZXIpIHtcbiAgICAgIG1vZGVsLnJvd3MgPSBtb2RlbC5yb3dzLm1hcCgocm93KSA9PiB7XG4gICAgICAgIHJvdy5jZWxscy5tYXAoKGRhdGVCdXR0b246IERhdGVCdXR0b24pID0+IHtcbiAgICAgICAgICBjb25zdCBkaXNhYmxlZCA9ICF0aGlzLnNlbGVjdEZpbHRlcihkYXRlQnV0dG9uLCBtb2RlbC52aWV3TmFtZSk7XG4gICAgICAgICAgZGF0ZUJ1dHRvbi5jbGFzc2VzWydkbC1hYmR0cC1kaXNhYmxlZCddID0gZGlzYWJsZWQ7XG4gICAgICAgICAgaWYgKGRpc2FibGVkKSB7XG4gICAgICAgICAgICBkYXRlQnV0dG9uLmNsYXNzZXNbJ2FyaWEtZGlzYWJsZWQnXSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBkYXRlQnV0dG9uO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJvdztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBtb2RlbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBgLmRsLWFiZHRwLWFjdGl2ZWAgY2VsbCBhZnRlciB0aGUgbWljcm90YXNrIHF1ZXVlIGlzIGVtcHR5LlxuICAgKiBAaW50ZXJuYWxcbiAgICoqL1xuICBwcml2YXRlIGZvY3VzQWN0aXZlQ2VsbCgpIHtcbiAgICB0aGlzLl9uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgdGhpcy5fbmdab25lLm9uU3RhYmxlLmFzT2JzZXJ2YWJsZSgpLnBpcGUodGFrZSgxKSkuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgdGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kbC1hYmR0cC1hY3RpdmUnKS5mb2N1cygpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyB0aGUgc3RhcnQgZGF0ZSBmb3IgdGhlIHBpY2tlci5cbiAgICogQGludGVybmFsXG4gICAqKi9cbiAgcHJpdmF0ZSBnZXRTdGFydERhdGUoKSB7XG4gICAgaWYgKGhhc1ZhbHVlKHRoaXMuX3ZhbHVlKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2RhdGVBZGFwdGVyLnRvTWlsbGlzZWNvbmRzKHRoaXMuX3ZhbHVlKTtcbiAgICB9XG4gICAgaWYgKGhhc1ZhbHVlKHRoaXMuc3RhcnREYXRlKSkge1xuICAgICAgcmV0dXJuIHRoaXMuc3RhcnREYXRlO1xuICAgIH1cbiAgICByZXR1cm4gbW9tZW50KCkudmFsdWVPZigpO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSB0aGUgc3RhcnQgdmlldyBmb3IgdGhlIHBpY2tlclxuICAgKiBAcmV0dXJuc1xuICAgKiAgdGhlIGxhcmdlc3QgdGltZSBpbmNyZW1lbnQgdmlldyBiZXR3ZWVuIHRoZSBgbWluVmlld2Agb3IgYG1pbnV0ZWAgdmlldyBhbmQgdGhlIGBzdGFydFZpZXdgIG9yIGBkYXlgIHZpZXcuXG4gICAqL1xuICBwcml2YXRlIGdldFN0YXJ0VmlldygpOiBzdHJpbmcge1xuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBNYXRoLm1heChWSUVXUy5pbmRleE9mKHRoaXMubWluVmlldyB8fCAnbWludXRlJyksIFZJRVdTLmluZGV4T2YodGhpcy5zdGFydFZpZXcgfHwgJ2RheScpKTtcbiAgICByZXR1cm4gVklFV1Nbc3RhcnRJbmRleF07XG4gIH1cblxuICAvKipcbiAgICogQ2FsbHMgYWxsIHJlZ2lzdGVyZWQgYHRvdWNoYCBjYWxsYmFjayBmdW5jdGlvbnMuXG4gICAqIEBpbnRlcm5hbFxuICAgKiovXG4gIHByaXZhdGUgb25Ub3VjaCgpIHtcbiAgICB0aGlzLl90b3VjaGVkLmZvckVhY2goKG9uVG91Y2hlZCkgPT4gb25Ub3VjaGVkKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlY2VpdmVzIGNvbmZpZ3VyYXRpb24gY2hhbmdlcyBkZXRlY3RlZCBieSBBbmd1bGFyIGFuZCBwYXNzZXMgdGhlIGNoYW5nZXMgb25cbiAgICogdG8gdGhlIG1vZGVsIHByb3ZpZGVycyBzbyB0aGUgcHJvdmlkZXIgaXMgYXdhcmUgb2YgYW55IG5lY2Vzc2FyeSBjb25maWd1cmF0aW9uXG4gICAqIGNoYW5nZXMgKGkuZS4gbWludXRlU3RlcClcbiAgICpcbiAgICogQHBhcmFtIGNoYW5nZXNcbiAgICogIHRoZSBpbnB1dCBjaGFuZ2VzIGRldGVjdGVkIGJ5IEFuZ3VsYXIuXG4gICAqL1xuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgT2JqZWN0LmtleXModGhpcy5fdmlld1RvTW9kZWxQcm92aWRlcilcbiAgICAgIC5tYXAoKGtleSkgPT4gdGhpcy5fdmlld1RvTW9kZWxQcm92aWRlcltrZXldKVxuICAgICAgLmZvckVhY2goKHByb3ZpZGVyOiBEbE1vZGVsUHJvdmlkZXIpID0+IHByb3ZpZGVyLm9uQ2hhbmdlcyhjaGFuZ2VzKSk7XG5cbiAgICBpZiAodGhpcy5fbW9kZWwpIHsgLy8gb25seSB1cGRhdGUgdGhlIG1vZGVsIGFmdGVyIG5nT25Jbml0IGhhcyBzZXQgaXQgdGhlIGZpcnN0IHRpbWUuXG4gICAgICB0aGlzLm1vZGVsID0gdGhpcy5fdmlld1RvTW9kZWxQcm92aWRlclt0aGlzLl9tb2RlbC52aWV3TmFtZV0uZ2V0TW9kZWwodGhpcy5fbW9kZWwuYWN0aXZlRGF0ZSwgdGhpcy52YWx1ZU9mKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgaW5pdGlhbCBtb2RlbC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqKi9cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5tb2RlbCA9IHRoaXMuX3ZpZXdUb01vZGVsUHJvdmlkZXJbdGhpcy5nZXRTdGFydFZpZXcoKV0uZ2V0TW9kZWwodGhpcy5nZXRTdGFydERhdGUoKSwgdGhpcy52YWx1ZU9mKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGNsaWNrIChhbmQgZW50ZXIgJiBzcGFjZSBrZXkgZG93bikgZXZlbnRzIG9uIHRoZSBkYXRlIGVsZW1lbnRzLlxuICAgKlxuICAgKiBJZiB0aGUgY3VycmVudCB2aWV3IGlzIHRoZSBtaW5pbXVtIHZpZXcgdGhlbiB0aGUgZGF0ZSB2YWx1ZSBpcyBzZWxlY3RlZFxuICAgKiBhbmQgdGhlIHBpY2tlciByZXR1cm5zIHRvIHRoZSBzdGFydCB2aWV3LlxuICAgKlxuICAgKiBPdGhlcndpc2UgdGhlIHBpY2tlciBkaXNwbGF5cyB0aGUgbmV4dCB2aWV3IHdpdGggdGhlIG5leHRcbiAgICogc21hbGxlc3QgdGltZSBpbmNyZW1lbnQuXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKiovXG4gIF9vbkRhdGVDbGljayhkYXRlQnV0dG9uOiBEYXRlQnV0dG9uKSB7XG4gICAgaWYgKGRhdGVCdXR0b24uY2xhc3Nlc1snZGwtYWJkdHAtZGlzYWJsZWQnXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBuZXh0VmlldyA9IHRoaXMuX25leHRWaWV3W3RoaXMuX21vZGVsLnZpZXdOYW1lXTtcblxuICAgIGlmICgodGhpcy5taW5WaWV3IHx8ICdtaW51dGUnKSA9PT0gdGhpcy5fbW9kZWwudmlld05hbWUpIHtcbiAgICAgIHRoaXMudmFsdWUgPSB0aGlzLl9kYXRlQWRhcHRlci5mcm9tTWlsbGlzZWNvbmRzKGRhdGVCdXR0b24udmFsdWUpO1xuICAgICAgbmV4dFZpZXcgPSB0aGlzLnN0YXJ0VmlldztcbiAgICB9XG5cbiAgICB0aGlzLm1vZGVsID0gdGhpcy5fdmlld1RvTW9kZWxQcm92aWRlcltuZXh0Vmlld10uZ2V0TW9kZWwoZGF0ZUJ1dHRvbi52YWx1ZSwgdGhpcy52YWx1ZU9mKTtcblxuICAgIHRoaXMub25Ub3VjaCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2xpY2sgKGFuZCBlbnRlciAmIHNwYWNlIGtleSBkb3duKSBldmVudHMgb24gdGhlIGxlZnQgYnV0dG9uLlxuICAgKlxuICAgKiBDaGFuZ2VzIHRoZSBkaXNwbGF5ZWQgdGltZSByYW5nZSBvZiB0aGUgcGlja2VyIHRvIHRoZSBwcmV2aW91cyB0aW1lIHJhbmdlLlxuICAgKiBGb3IgZXhhbXBsZSwgaW4geWVhciB2aWV3LCB0aGUgcHJldmlvdXMgZGVjYWRlIGlzIGRpc3BsYXllZC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqKi9cbiAgX29uTGVmdENsaWNrKCkge1xuICAgIHRoaXMubW9kZWwgPSB0aGlzLl92aWV3VG9Nb2RlbFByb3ZpZGVyW3RoaXMuX21vZGVsLnZpZXdOYW1lXS5nZXRNb2RlbCh0aGlzLl9tb2RlbC5sZWZ0QnV0dG9uLnZhbHVlLCB0aGlzLnZhbHVlT2YpO1xuICAgIHRoaXMub25Ub3VjaCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2xpY2sgKGFuZCBlbnRlciAmIHNwYWNlIGtleSBkb3duKSBldmVudHMgb24gdGhlIHVwIGJ1dHRvbi5cbiAgICpcbiAgICogQ2hhbmdlcyB0aGUgdmlldyBvZiB0aGUgcGlja2VyIHRvIHRoZSBuZXh0IGxhcmdlc3QgdGltZSBpbmNyZW1lbnQuXG4gICAqIEZvciBleGFtcGxlLCBpbiBkYXkgdmlldywgdGhlIG5leHQgdmlldyBkaXNwbGF5ZWQgd2lsbCBiZSBtb250aCB2aWV3LlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICoqL1xuICBfb25VcENsaWNrKCkge1xuICAgIHRoaXMubW9kZWwgPSB0aGlzLl92aWV3VG9Nb2RlbFByb3ZpZGVyW3RoaXMuX3ByZXZpb3VzVmlld1t0aGlzLl9tb2RlbC52aWV3TmFtZV1dLmdldE1vZGVsKHRoaXMuX21vZGVsLnVwQnV0dG9uLnZhbHVlLCB0aGlzLnZhbHVlT2YpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2xpY2sgKGFuZCBlbnRlciAmIHNwYWNlIGtleSBkb3duKSBldmVudHMgb24gdGhlIHJpZ2h0IGJ1dHRvbi5cbiAgICpcbiAgICogQ2hhbmdlcyB0aGUgZGlzcGxheWVkIHRpbWUgcmFuZ2Ugb2YgdGhlIHBpY2tlciB0byB0aGUgbmV4dCB0aW1lIHJhbmdlLlxuICAgKiBGb3IgZXhhbXBsZSwgaW4geWVhciB2aWV3LCB0aGUgbmV4dCBkZWNhZGUgaXMgZGlzcGxheWVkLlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICoqL1xuICBfb25SaWdodENsaWNrKCkge1xuICAgIHRoaXMubW9kZWwgPSB0aGlzLl92aWV3VG9Nb2RlbFByb3ZpZGVyW3RoaXMuX21vZGVsLnZpZXdOYW1lXS5nZXRNb2RlbCh0aGlzLl9tb2RlbC5yaWdodEJ1dHRvbi52YWx1ZSwgdGhpcy52YWx1ZU9mKTtcbiAgICB0aGlzLm9uVG91Y2goKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIHZhcmlvdXMga2V5IGRvd24gZXZlbnRzIHRvIG1vdmUgdGhlIGBhY3RpdmUgZGF0ZWAgYXJvdW5kIHRoZSBjYWxlbmRhci5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqKi9cbiAgX2hhbmRsZUtleURvd24oJGV2ZW50OiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgZnVuY3Rpb25OYW1lID0ga2V5Q29kZVRvTW9kZWxQcm92aWRlck1ldGhvZFskZXZlbnQua2V5XTtcblxuICAgIGNvbnNvbGUubG9nKCRldmVudCwgZnVuY3Rpb25OYW1lKTtcblxuICAgIGlmIChmdW5jdGlvbk5hbWUpIHtcbiAgICAgIGNvbnN0IG1vZGVsUHJvdmlkZXIgPSB0aGlzLl92aWV3VG9Nb2RlbFByb3ZpZGVyW3RoaXMuX21vZGVsLnZpZXdOYW1lXTtcbiAgICAgIHRoaXMubW9kZWwgPSBtb2RlbFByb3ZpZGVyW2Z1bmN0aW9uTmFtZV0odGhpcy5fbW9kZWwuYWN0aXZlRGF0ZSwgdGhpcy52YWx1ZU9mKTtcblxuICAgICAgdGhpcy5mb2N1c0FjdGl2ZUNlbGwoKTtcbiAgICAgIC8vIFByZXZlbnQgdW5leHBlY3RlZCBkZWZhdWx0IGFjdGlvbnMgc3VjaCBhcyBmb3JtIHN1Ym1pc3Npb24uXG4gICAgICAkZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3Nvci5yZWdpc3Rlck9uQ2hhbmdlIHRvIHJlZ2lzdGVyIGNoYW5nZSBsaXN0ZW5lcnMuXG4gICAqIEBpbnRlcm5hbFxuICAgKiovXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46ICh2YWx1ZTogRCkgPT4gdm9pZCkge1xuICAgIHRoaXMuX2NoYW5nZWQucHVzaChmbik7XG4gIH1cblxuICAvKipcbiAgICogSW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3Nvci5yZWdpc3Rlck9uVG91Y2hlZCB0byByZWdpc3RlciB0b3VjaCBsaXN0ZW5lcnMuXG4gICAqIEBpbnRlcm5hbFxuICAgKiovXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiAoKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5fdG91Y2hlZC5wdXNoKGZuKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbXBsZW1lbnRzIENvbnRyb2xWYWx1ZUFjY2Vzc29yLndyaXRlVmFsdWUgdG8gc3RvcmUgdGhlIHZhbHVlIGZyb20gdGhlIG1vZGVsLlxuICAgKiBAaW50ZXJuYWxcbiAgICoqL1xuICB3cml0ZVZhbHVlKHZhbHVlOiBEKSB7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICB9XG5cbn1cblxuLyoqIEBpbnRlcm5hbCAqL1xuZnVuY3Rpb24gaGFzVmFsdWUodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xuICByZXR1cm4gKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpICYmICh2YWx1ZSAhPT0gbnVsbCk7XG59XG4iXX0=